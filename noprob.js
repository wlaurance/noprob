// Generated by CoffeeScript 1.3.3
(function() {
  var currentTime, exec, execAndPipe, fs;

  fs = require('fs');

  exec = require('child_process').exec;

  execAndPipe = function(execString) {
    var piper;
    piper = exec(execString);
    piper.stderr.on('data', function(data) {
      return process.stderr.write(data.toString());
    });
    return piper.stdout.on('data', function(data) {
      return process.stdout.write(data.toString());
    });
  };

  currentTime = function() {
    return Math.round(new Date().getTime() / 1000);
  };

  exports.run = function() {
    var lastTime, watcher;
    lastTime = currentTime();
    if (process.platform === 'darwin') {
      watcher = function(cb) {
        var piper;
        piper = exec("find -L . -type f -mtime -" + (currentTime() - lastTime) + "s -print");
        piper.stdout.on('data', function(data) {
          cb(data.toString());
          return lastTime = currentTime() + 1;
        });
        piper.stderr.on('data', function(data) {
          return process.stderr.write(data.toString());
        });
        return piper.on('exit', function(code) {
          return setTimeout((function() {
            return watcher(cb);
          }), 500);
        });
      };
      return watcher(function(files) {
        return console.log(files);
      });
    } else if (!(fs.watch != null)) {
      return console.log('ass');
    }
  };

}).call(this);
